(self.webpackChunknote=self.webpackChunknote||[]).push([[151],{7704:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var r=n(2791),s=n(7689),a=n(6459),o={LOGIN:"/login",REGISTER:"/register",AUTHENTICATE:{PREFIX:"users",NOTES:"/notes"},HOME:"/"},i=function(){return"/".concat(o.AUTHENTICATE.PREFIX).concat(o.AUTHENTICATE.NOTES)},c=function(){return"".concat(o.LOGIN)},u=function(){return"".concat(o.REGISTER)},l=n(9434),d=n(4165),f=n(5861),p=n(626),m=n(6433),x=n(6972),h=n(5573),v=function(e){return m.pbkdf2Sync(e,x.Z.getValue(h.Z.REACT_APP_SALT),2048,32,"sha512").toString("hex")},g=n(184),j=function(e){(0,a.Z)(e);var t=(0,l.I0)(),n=(0,s.s0)(),r=function(){var e=(0,f.Z)((0,d.Z)().mark((function e(r){var s,a,o,c,u,l,f;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),s=document.forms[0],a=s.user_name,o=s.password,c=a.value,u=o.value,l=v(u),e.t0=t,e.next=8,(0,p.x)({user_name:c,password:l});case 8:return e.t1=e.sent,e.next=11,(0,e.t0)(e.t1);case 11:if(!(f=e.sent).error){e.next=15;break}return alert(f.error.message),e.abrupt("return");case 15:n(i());case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,g.jsx)("div",{className:"login",children:(0,g.jsxs)("form",{className:"form",onSubmit:r,children:[(0,g.jsx)("input",{className:"input-user-name",name:"user_name",placeholder:"user name",required:!0}),(0,g.jsx)("input",{className:"input-password",name:"password",type:"password",placeholder:"password",required:!0}),(0,g.jsx)("button",{type:"submit",className:"button",children:"Login"}),(0,g.jsx)("button",{type:"button",onClick:function(){n(u())},className:"link-register button",children:"Register"})]})})},N=function(e){(0,a.Z)(e);var t=(0,l.v9)((function(e){return e.loginReducer.isLogged})),n=(0,s.s0)();return(0,r.useEffect)((function(){t&&n(i())}),[]),t?null:(0,g.jsx)(j,{})},b="auth/register",E=n(5605),C=n(1960),w=n(8133),k=(0,E.hg)(b,function(){var e=(0,f.Z)((0,d.Z)().mark((function e(t,n){var r,s,a;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.next=3,C.Z.post("/register",t);case 3:if(s=e.sent,a=s.data.data,!w.Z.isFail(s.status)&&!("error"in a)){e.next=7;break}return e.abrupt("return",r(a));case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),y=function(e){(0,a.Z)(e);var t=(0,l.I0)(),n=(0,s.s0)(),r=function(){var e=(0,f.Z)((0,d.Z)().mark((function e(r){var s,a,o,i,u,l,f,p,m,x;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),s=document.forms[0],a=s.user_name,o=s.password,i=s.password_confirmation,u=a.value,l=o.value,f=i.value,p=v(l),m=v(f),p===m){e.next=10;break}return alert("Password must be the same"),e.abrupt("return");case 10:return e.t0=t,e.next=13,k({user_name:u,password:p,password_confirmation:m});case 13:return e.t1=e.sent,e.next=16,(0,e.t0)(e.t1);case 16:if(!(x=e.sent).error){e.next=20;break}return alert(x.error.message),e.abrupt("return");case 20:alert("Register success"),n(c());case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,g.jsx)("div",{className:"register",children:(0,g.jsxs)("form",{className:"form",onSubmit:r,children:[(0,g.jsx)("input",{className:"input-user-name",name:"user_name",placeholder:"user name",required:!0}),(0,g.jsx)("input",{className:"input-password",name:"password",type:"password",placeholder:"password",required:!0}),(0,g.jsx)("input",{className:"input-password",name:"password_confirmation",type:"password",placeholder:"password confirmation",required:!0}),(0,g.jsx)("button",{type:"submit",className:"button",children:"Register"}),(0,g.jsx)("button",{type:"button",onClick:function(){n(c())},className:"link-register button",children:"Login"})]})})},T=n(6856),Z=n(71),R=n(1759),S=n(7537),A=function(){var e=(0,l.I0)(),t=(0,l.v9)((function(e){return e.notesReducer.notes})),n=(0,l.v9)((function(e){var t;return null===(t=e.notesReducer.currentNote)||void 0===t?void 0:t._id})),r=0===t.length?"notes-delete-empty":"";return(0,g.jsxs)("div",{className:"notes-toolbar-container",children:[(0,g.jsx)(T.F1H,{onClick:function(){e((0,R.f_)(n))},className:"notes-cursor ".concat(r),"aria-disabled":!0}),(0,g.jsx)(Z.orQ,{onClick:function(){var t=S.H;e((0,R.kT)(t))},className:"notes-cursor"})]})},I=function(e){var t=e.item,n=(0,l.I0)(),s=(0,l.v9)((function(e){return e.notesReducer.currentNote})),a=t.text,o=t.created_at,i=t.title,c=t._id,u=t.updated_at,d=(0,r.useCallback)((function(){n((0,R.iV)(t))}),[c,u]),f=function(e){return e.length>25?"".concat(e.substring(0,25),"..."):e},p=(null===s||void 0===s?void 0:s._id)===c?"active":"";return(0,g.jsxs)("div",{className:"notes-items notes-cursor ".concat(p),onClick:d,children:[(0,g.jsx)("h4",{className:"notes-margin-0 notes-ff",children:f(i)}),(0,g.jsxs)("div",{className:"notes-body",children:[(0,g.jsx)("span",{className:"notes-margin-0",children:o}),(0,g.jsx)("span",{className:"notes-margin-0 notes-ml-10 notes-cl-gray",children:f(a)})]})]})},_=function(e){(0,a.Z)(e);var t=(0,l.I0)();(0,r.useEffect)((function(){t((0,R.Kk)())}),[]);var n=(0,l.v9)((function(e){return e.notesReducer.notes}));return(0,g.jsxs)("div",{className:"notes-wrapper",children:[(0,g.jsx)("div",{className:"",children:(0,g.jsx)(A,{})}),(0,g.jsx)("div",{className:"notes-container",children:(0,g.jsx)("div",{children:n.map((function(e){return(0,g.jsx)(I,{item:e},e._id)}))})})]})},L=n(885),H=n(2010),F=n(6183),O=(n(3321),n(5088),(0,n(8840).Z)()),U="header-one",P=function(e){var t=e.id,n=e.editorState,s=e.onChange,a=(0,r.useCallback)((function(e){e.getCurrentContent().equals(n.getCurrentContent())||s(o(e))}),[t]),o=function(e){var t=e.getCurrentContent().getBlockMap().first().getKey();return e.getSelection().getAnchorKey()===t!==(H.RichUtils.getCurrentBlockType(e)===U)?H.RichUtils.toggleBlockType(e,U):e};return(0,g.jsx)(F.ZP,{editorState:n,onChange:a,plugins:[O]})},W=n(5095),q=n.n(W),B=function(e){var t=e.editorState,n=e.currentNote,s=e.onChangeEditor,a=n._id,o=(0,l.I0)();(0,r.useEffect)((function(){if(n.content){var e=H.EditorState.createWithContent((0,H.convertFromRaw)(JSON.parse(n.content)));s(e)}else s(H.EditorState.createEmpty())}),[a]);var i=q()((function(e){var t=c(e);o((0,R.Qk)(t))}),100),c=function(e){var t,n=(0,H.convertToRaw)(e.getCurrentContent());return n&&0!==n.blocks.length?{title:n.blocks[0].text||S.H.title,text:(null===(t=n.blocks[1])||void 0===t?void 0:t.text)||S.H.text,content:JSON.stringify(n),_id:a}:null};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("label",{className:"editor-lbl-created-at",children:null===n||void 0===n?void 0:n.updated_at}),(0,g.jsx)("div",{className:"editor-wrap-draftjs",children:(0,g.jsx)(P,{id:a,editorState:t,onChange:function(e){i(e),s(e)}})})]})},G=n(9126),M=function(e){var t=e.editorState,n=e.onChangeEditor,r=(0,l.I0)(),a=(0,s.s0)(),o=function(e,t){if(e.stopPropagation(),e.preventDefault(),0!==e.target.files.length){var n=e.target.files[0];i(n,(function(e){t(e)}))}},i=function(){var e=(0,f.Z)((0,d.Z)().mark((function e(t,n){var r;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=new FileReader).readAsDataURL(t),r.onload=function(){n(r.result)},r.onerror=function(e){return e};case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(e,t){var n=e.getCurrentContent().createEntity("image","IMMUTABLE",{src:t}),r=n.getLastCreatedEntityKey(),s=H.EditorState.set(e,{currentContent:n});return H.AtomicBlockUtils.insertAtomicBlock(s,r," ")};return(0,g.jsxs)("div",{className:"editor-toolbar-container",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"file",children:(0,g.jsx)(G.jnY,{className:"editor-cursor"})}),(0,g.jsx)("input",{onChange:function(e){o(e,(function(e){var r=u(t,e);n(r)}))},type:"file",id:"file",style:{display:"none"}})]}),(0,g.jsx)("button",{onClick:function(){r((0,p.k)()),a(c())},className:"btn-logout",children:"Logout"})]})},D=function(e){(0,a.Z)(e);var t=(0,l.v9)((function(e){return e.notesReducer.currentNote})),n=(0,r.useState)((function(){return H.EditorState.createEmpty()})),s=(0,L.Z)(n,2),o=s[0],i=s[1],c=function(e){i(e)};return(0,g.jsxs)("div",{className:"editor-container",children:[(0,g.jsx)("div",{children:(0,g.jsx)(M,{onChangeEditor:c,editorState:o})}),t&&t._id&&(0,g.jsx)(B,{currentNote:t,onChangeEditor:c,editorState:o})]})},K=function(){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"app-wrap-note",children:(0,g.jsx)(_,{})}),(0,g.jsx)("div",{className:"app-wrap-editor",children:(0,g.jsx)(D,{})})]})},V=function(){return(0,g.jsx)(s.Z5,{children:(0,g.jsx)(s.AW,{path:o.AUTHENTICATE.NOTES,element:(0,g.jsx)(K,{})})})},X=function(e){(0,a.Z)(e);var t=(0,l.v9)((function(e){return e.loginReducer.isLogged})),n=(0,s.s0)();return(0,r.useEffect)((function(){t||n(c())}),[]),t?(0,g.jsx)(V,{}):null};var J=function(){return(0,g.jsxs)(s.Z5,{children:[(0,g.jsx)(s.AW,{path:"".concat(o.AUTHENTICATE.PREFIX,"/*"),element:(0,g.jsx)(X,{})}),(0,g.jsx)(s.AW,{path:o.REGISTER,element:(0,g.jsx)(y,{})}),(0,g.jsx)(s.AW,{path:o.LOGIN,element:(0,g.jsx)(N,{})}),(0,g.jsx)(s.AW,{path:o.HOME,element:(0,g.jsx)(N,{})})]})}},950:function(){},6601:function(){},9214:function(){},8623:function(){},7748:function(){},5568:function(){},6619:function(){},7108:function(){},2361:function(){},4616:function(){}}]);
//# sourceMappingURL=151.f490b549.chunk.js.map